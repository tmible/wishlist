# wishlist-bot
Телеграм бот со списками желаний

# Требования к удалённой машине
## Внешние зависимости
- node
- pnpm
- rsync (ддя деплоя)
- certbot
- nginx

## Переменные окружения
- `BOT_TOKEN` токен бота
- `WISHLIST_DB_FILE_PATH` путь к SQLite БД со списками желаний
- `WISHLIST_DB_MIGRATIONS_PATH` путь к папке с SQL скриптами миграций БД со списками желаний
- `LOCAL_DB_PATH` путь к LevelDB БД для горячих данных
- `LOGS_DB_FILE_PATH` путь к SQLite БД для хранения логов
- `LOGS_DB_MIGRATIONS_PATH` путь к папке с SQL скриптами миграций БД для хранения логов
- `HOST` https://используемый_домен
- `PORT` порт для внутреннего сервера
- `HUB_SOCKET_PATH` путь к UNIX сокету IPC хаба для синхронизации списков желаний

## Сетевые требования
Бот работает на вебхуках. Поэтому ему нужен reverse proxy с доменом и сертификатом
- nginx, конфигурация которого включает следующий фрагмент:
```nginx
http {
    server {
        server_name {{ используемый_домен }};
        location / {
            proxy_pass http://localhost:{{ порт для внутреннего сервера }};
        }
    }
}
```
- домен. Указывается в переменной окружения и в конфигурации nginx
- TLS сертификат. Устанавливается автоматически с помощью certbot

## Разработка
Если не задать переменные окружения `HOST` и `PORT`, бот запустится в режиме long polling.
